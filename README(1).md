# 深海鱼类识别系统

## 项目名称
深海鱼类识别系统（Deep Sea Fish Recognition System）

---

## 项目简介

深海鱼类识别系统是一个基于人工智能的实时检测与分析平台，旨在通过图像和视频处理技术，实现对深海鱼类的精准识别、统计与预警。系统集成了深度学习模型（YOLO）、WebSocket实时通信、语音问答交互及历史记录管理等功能模块，为用户提供全面的鱼类识别解决方案。

---

## 项目目的

1. **科学研究**：辅助海洋生物学家快速识别深海鱼类种类，提升研究效率。
2. **生态保护**：监测特定海域的鱼类种群变化，评估生态环境健康状况。
3. **教育与科普**：通过智能问答与可视化展示，向公众普及鱼类知识。
4. **渔业管理**：帮助渔民优化捕捞策略，监控渔场鱼类活动。

---

## 核心功能

1. **图像/视频上传与检测**
   - 支持用户上传图片或视频文件进行鱼类识别。
   - 提供详细的检测结果，包括目标数量、置信度、位置坐标等信息。
   - 结果可视化展示：标注框、表格数据、趋势图表。

2. **实时摄像头检测**
   - 集成摄像头控制模块，支持实时视频流捕获与帧处理。
   - 基于WebSocket实现实时检测结果推送与展示。

3. **智能问答**
   - 内置语音识别与自然语言处理模块，支持用户通过语音或文本提问。
   - 基于Ollama模型提供专业鱼类知识解答。

4. **历史记录管理**
   - 记录每次检测的详细信息，包括时间戳、检测类型、目标数量等。
   - 提供图表化趋势分析，帮助用户了解检测数据的变化规律。

5. **多角色权限管理**
   - 支持管理员与普通用户两种角色，分别提供不同的功能权限。
   - 管理员可查看全局统计数据与趋势分析，普通用户仅限于基础检测功能。

6. **实时报警系统**
   - 对低置信度检测结果进行实时报警提示。
   - 报警信息通过WebSocket推送到前端，并以动画形式展示。

---

## 使用场景

1. **科研领域**
   - 海洋生物学家可以通过系统快速识别深海鱼类种类，辅助科学研究。
   - 提供历史数据统计与趋势分析，帮助研究人员发现鱼类分布规律。

2. **生态保护**
   - 监测特定海域的鱼类种群变化，评估生态环境健康状况。
   - 实时报警功能可用于发现异常情况（如外来物种入侵）。

3. **教育与科普**
   - 学校与科普机构可以利用系统的智能问答功能，向学生普及鱼类知识。
   - 可视化的检测结果便于非专业人士理解。

4. **渔业管理**
   - 渔民可通过系统识别捕捞到的鱼类种类，优化捕捞策略。
   - 实时检测功能可用于监控渔场鱼类活动。

---

## 安装说明

### 环境要求
- Python >= 3.11
- Node.js >= 16
- 浏览器支持HTML5与WebSocket

### 前端安装
1. **克隆仓库**
   ```bash
   git clone https://github.com/your-repo/deep-sea-fish-recognition.git
   cd deep-sea-fish-recognition/front_phase_2
   ```

2. **安装依赖**
   ```bash
   npm install
   ```

3. **启动开发服务器**
   ```bash
   npm run serve
   ```


### 后端安装
1. **安装Python依赖**
   ```bash
   pip install -r requirements.txt
   ```

2. **启动FastAPI服务**
   ```bash
   uvicorn main:app --reload
   ```


---

## 使用说明

### 文件上传
1. 打开系统主页面，点击“图片上传”或“视频上传”按钮。
2. 选择本地文件并上传，系统将自动进行检测。
3. 查看检测结果，包括标注框、表格数据和趋势图表。

### 实时检测
1. 点击“开启摄像头”按钮，启动摄像头。
2. 点击“开始检测”按钮，系统将实时捕获视频帧并进行检测。
3. 查看实时检测结果，支持暂停与停止操作。

### 智能问答
1. 点击智能问答面板的触发按钮，展开问答界面。
2. 输入问题或点击语音按钮进行语音提问。
3. 系统将基于当前检测结果或鱼类知识库提供答案。

### 历史记录
1. 点击“历史检测”按钮，进入历史记录页面。
2. 查看所有检测记录，支持按图片或视频分类浏览。
3. 查看趋势图表，了解检测数据的变化规律。

---

## 开发指南

### 新增功能
1. **添加新页面**
   - 在`html/`目录下创建新的HTML文件。
   - 在`css/`目录下添加对应的样式文件。
   - 在`js/`目录下创建新的脚本文件，并在HTML中引用。

2. **新增API**
   - 在`main.py`中定义新的路由。
   - 使用FastAPI的装饰器（如`@app.post`）定义接口逻辑。

### 调试工具
- **Postman**: 测试API接口。
- **Chrome DevTools**: 调试前端代码。
- **TensorBoard**: 可视化模型训练过程。

---

## 接口文档

### WebSocket 接口

#### 连接地址
- `ws://localhost:8000/ws/fish-detection`

#### 消息格式
```json
{
  "alert": "发现低置信度目标",
  "detections": [
    {
      "fish_cn": "蓝吊",
      "fish_en": "BlueTang",
      "confidence": 0.85,
      "bbox": [x1, y1, x2, y2]
    }
  ]
}
```


#### 字段说明
- `alert`: 报警信息（可选）。
- `detections`: 检测结果数组。
  - `fish_cn`: 鱼类中文名称。
  - `fish_en`: 鱼类英文名称。
  - `confidence`: 置信度（0-1之间的小数）。
  - `bbox`: 目标边界框坐标（左上角与右下角坐标）。

---

### RESTful API 接口

#### 文件上传接口
- **URL**: `/upload/image` 或 `/upload/video`
- **Method**: POST
- **Headers**:
  - `Authorization`: Basic Auth
- **Body**:
  - `file`: 图片或视频文件
- **Response**:
  ```json
  {
    "detections": [
      {
        "fish_cn": "神仙鱼",
        "fish_en": "AngelFish",
        "confidence": 0.95,
        "bbox": [x1, y1, x2, y2]
      }
    ],
    "fps": 30
  }
  ```


#### 字段说明
- `detections`: 检测结果数组。
  - `fish_cn`: 鱼类中文名称。
  - `fish_en`: 鱼类英文名称。
  - `confidence`: 置信度（0-1之间的小数）。
  - `bbox`: 目标边界框坐标（左上角与右下角坐标）。
- `fps`: 视频帧率（仅适用于视频上传）。

---

### 智能问答接口

#### 请求地址
- `POST /ask-question`

#### 请求头
- `Content-Type: application/json`
- `Authorization: Bearer <token>`

#### 请求体
```json
{
  "prompt": "当前检测的鱼类是什么？",
  "context": {
    "detections": [
      {
        "fish_cn": "蓝吊",
        "fish_en": "BlueTang",
        "confidence": 0.85,
        "bbox": [x1, y1, x2, y2]
      }
    ]
  }
}
```


#### 响应体
```json
{
  "response": "当前检测到的鱼类是蓝吊，置信度为85%。",
  "error": null
}
```


---

## 贡献指南

欢迎贡献代码！请遵循以下步骤：
1. Fork本仓库。
2. 创建新分支（`git checkout -b feature/your-feature-name`）。
3. 提交更改（`git commit -m "Add your feature"`）。
4. 推送分支（`git push origin feature/your-feature-name`）。
5. 提交Pull Request。

---

## 许可证

本项目采用MIT许可证。详见[LICENSE](LICENSE)文件。

---

## 联系方式

如有任何问题，请联系：
- 邮箱: 956513918@qq.com
- GitHub: https://github.com/IceQ1021/fish_detection

--- 
